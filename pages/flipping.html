<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flipping - Farmers de Azeroth</title>
    <link rel="icon" type="image/jpeg" href="/channels4_profile.jpg">

    <!-- Tailwind CSS (via CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind Config -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              wow: {
                dark: "#0b0c10",
                card: "#1a1d29",
                border: "#2a2e3b",
                blue: "#0074e0",
                gold: "#ffd100",
                success: "#22c55e",
              },
            },
            fontFamily: {
              sans: ["Inter", "sans-serif"],
            },
          },
        },
      };
    </script>

    <link rel="stylesheet" href="/style.css" />
  </head>

  <body class="text-white font-sans min-h-screen flex flex-col">
    <div id="header-placeholder" class="shrink-0 sticky top-0 z-50"></div>

    <main class="flex-1 flex flex-col">
      <div class="flex-1 w-full max-w-7xl mx-auto p-4 md:p-8">
        <!-- Header -->
        <div class="mb-8">
          <h1 class="text-3xl md:text-4xl font-bold text-white mb-2 text-wow-gold">
            Flipping
          </h1>
          <p class="text-gray-500 text-sm">
            Ítems recomendados para farmear con precios actualizados de la casa de subastas (NA)
          </p>
        </div>

        <!-- Info Card -->
        <div class="bg-gradient-to-r from-blue-900/40 to-blue-900/10 border-l-4 border-wow-blue rounded-r-lg p-4 mb-6 flex items-start gap-3">
          <i class="fas fa-info-circle text-wow-blue mt-1"></i>
          <div class="text-sm text-gray-300">
            <p class="font-semibold mb-1">Precios actualizados automáticamente</p>
            <p class="text-xs text-gray-400">Los precios se actualizan cada hora (08:00 - 23:00). Última actualización: <span id="last-update-time">--:--</span></p>
          </div>
        </div>

        <!-- Farmeos Table -->
        <div class="bg-wow-card border border-wow-border rounded-xl shadow-lg overflow-hidden">
          <div class="overflow-x-auto">
            <table class="w-full text-left text-sm">
              <thead class="text-[10px] md:text-xs uppercase text-gray-500 border-b border-wow-border bg-wow-dark">
                <tr>
                  <th class="py-1.5 px-2 md:py-3 md:px-4 text-left">Ítem</th>
                  <th class="py-1.5 px-2 md:py-3 md:px-4 text-left">Precio Subasta</th>
                  <th class="py-1.5 px-2 md:py-3 md:px-4 text-left">Disponible</th>
                  <th class="py-1.5 px-2 md:py-3 md:px-4 text-left">Tutorial</th>
                </tr>
              </thead>
              <tbody id="farmeos-table-body" class="divide-y divide-wow-border/30">
                <!-- Se llenará dinámicamente -->
                <tr>
                  <td colspan="4" class="py-12 text-center">
                    <div class="flex flex-col items-center gap-3">
                      <i class="fas fa-spinner fa-spin text-3xl text-wow-blue"></i>
                      <p class="text-gray-400">Cargando farmeos sugeridos...</p>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="pb-20"></div>
      </div>
      <div id="footer-placeholder" class="w-full shrink-0"></div>
    </main>

    <!-- Scripts con carga optimizada -->
    <script type="module" src="/js/farmeos.js"></script>
    <script>
      // Carga paralela de componentes
      const loadComponent = (id, path, isHeader = false) => {
        return fetch(path)
          .then(res => res.text())
          .then(html => {
            const el = document.getElementById(id);
            if (el) {
              el.innerHTML = html;
              if (isHeader) {
                // Ejecutar scripts del header si existen
                const scripts = el.getElementsByTagName('script');
                for (let i = 0; i < scripts.length; i++) {
                  eval(scripts[i].innerText);
                }
              }
            }
          })
          .catch(err => console.error(`Error loading ${path}:`, err));
      };

      // Iniciar todas las cargas al mismo tiempo
      Promise.all([
        loadComponent('header-placeholder', '/components/header.html', true),
        loadComponent('footer-placeholder', '/components/footer.html')
      ]);
    </script>
  </body>
</html>
